'use strict';Object.defineProperty(exports,'__esModule',{value:true});exports.sortablePropTypes=undefined;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if('value'in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();exports.default=sortable;var _react=require('react');var _react2=_interopRequireDefault(_react);var _propTypes=require('prop-types');var _propTypes2=_interopRequireDefault(_propTypes);var _utils=require('./utils');function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _toConsumableArray(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}else{return Array.from(arr)}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError('Cannot call a class as a function')}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called')}return call&&(typeof call==='object'||typeof call==='function')?call:self}function _inherits(subClass,superClass){if(typeof superClass!=='function'&&superClass!==null){throw new TypeError('Super expression must either be null or a function, not '+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var omitUndefined=function omitUndefined(obj){return(0,_utils.omitBy)(obj,_utils.isUndef)};function sortable(){var options=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};return function(WrappedComponent){var _class,_temp;return _temp=_class=function(_React$Component){_inherits(Sortable,_React$Component);_createClass(Sortable,[{key:'config',get:function get(){return _extends({},options,this.props)}}]);function Sortable(props){_classCallCheck(this,Sortable);var _this=_possibleConstructorReturn(this,(Sortable.__proto__||Object.getPrototypeOf(Sortable)).call(this,props));var _this$config=_this.config,_this$config$initialA=_this$config.initialAscending,initialAscending=_this$config$initialA===undefined?true:_this$config$initialA,initialSortPath=_this$config.initialSortPath,initialSortFunc=_this$config.initialSortFunc;_this.state={ascending:initialAscending,sortPath:initialSortPath,sortFunc:initialSortFunc};_this.sort=_this.sort.bind(_this);_this.setAscending=_this.setAscending.bind(_this);_this.setDescending=function(val){return _this.setAscending(!val)};_this.setSortFunc=_this.setSortFunc.bind(_this);_this.setSortPath=_this.setSortPath.bind(_this);return _this}_createClass(Sortable,[{key:'componentWillReceiveProps',value:function componentWillReceiveProps(_ref){var ascending=_ref.ascending,sortPath=_ref.sortPath,sortFunc=_ref.sortFunc;this.setState(omitUndefined({ascending:ascending,sortPath:sortPath,sortFunc:sortFunc}))}},{key:'componentDidUpdate',value:function componentDidUpdate(oldProps,oldState){if((0,_utils.isEqual)(oldState,this.state))return;var onChange=this.config.onChange;if(onChange)return onChange(this.state)}},{key:'setAscending',value:function setAscending(ascending){this.setState({ascending:ascending})}},{key:'setSortFunc',value:function setSortFunc(sortFunc){this.setState({sortFunc:sortFunc})}},{key:'setSortPath',value:function setSortPath(newPath){var doToggle=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;var _state=this.state,sortPath=_state.sortPath,ascending=_state.ascending;if(newPath===sortPath){if(doToggle)ascending=!ascending}else{ascending=true}this.setState({sortPath:newPath,ascending:ascending})}},{key:'sort',value:function sort(array){var _state2=this.state,ascending=_state2.ascending,sortFunc=_state2.sortFunc,sortPath=_state2.sortPath;var disableReverse=this.config.disableReverse;if(sortFunc){var sorted=[].concat(_toConsumableArray(array)).sort(sortFunc);if(!ascending&&!disableReverse)sorted.reverse();return sorted}else{var order=ascending?'asc':'desc';var _sorted=(0,_utils.orderBy)(array,function(item){return(0,_utils.get)(sortPath,item)},order);return _sorted}}},{key:'render',value:function render(){var _state3=this.state,ascending=_state3.ascending,sortPath=_state3.sortPath;return _react2.default.createElement(WrappedComponent,_extends({ascending:ascending,descending:!ascending,sortPath:sortPath,sort:this.sort,setAscending:this.setAscending,setDescending:this.setDescending,setSortFunc:this.setSortFunc,setSortPath:this.setSortPath},this.props))}}]);return Sortable}(_react2.default.Component),_class.displayName=(0,_utils.wrapDisplayName)(WrappedComponent,'sortable'),_temp}}var sortablePropTypes=exports.sortablePropTypes={ascending:_propTypes2.default.bool.isRequired,descending:_propTypes2.default.bool.isRequired,sortPath:_propTypes2.default.string.isRequired,sort:_propTypes2.default.func.isRequired,setAscending:_propTypes2.default.func.isRequired,setDescending:_propTypes2.default.func.isRequired,setSortPath:_propTypes2.default.func.isRequired,setSortFunc:_propTypes2.default.func.isRequired};